训练准备......
{'cardboard': 0, 'glass': 1, 'metal': 2, 'paper': 3, 'plastic': 4, 'trash': 5}
加载预训练模型
训练开始......
C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
epoch:0/100 	 train_acc:54.90195846557617 	 val_acc:71.9565200805664 	 train_loss:0.8713106513023376 	 val_loss:0.8535640835762024
epoch:1/100 	 train_acc:83.4422607421875 	 val_acc:81.08695220947266 	 train_loss:0.4994257986545563 	 val_loss:0.5987635254859924
epoch:2/100 	 train_acc:90.25054168701172 	 val_acc:84.99999237060547 	 train_loss:0.22174300253391266 	 val_loss:0.44177302718162537
epoch:3/100 	 train_acc:93.8997802734375 	 val_acc:87.17391204833984 	 train_loss:0.29070621728897095 	 val_loss:0.3856905400753021
epoch:4/100 	 train_acc:96.02396392822266 	 val_acc:90.2173843383789 	 train_loss:0.1606731116771698 	 val_loss:0.31344667077064514
epoch:5/100 	 train_acc:97.49455261230469 	 val_acc:89.78260803222656 	 train_loss:0.10166666656732559 	 val_loss:0.25420907139778137
epoch:6/100 	 train_acc:98.42047882080078 	 val_acc:91.08695220947266 	 train_loss:0.11075139790773392 	 val_loss:0.2936430275440216
epoch:7/100 	 train_acc:98.74727630615234 	 val_acc:91.73912811279297 	 train_loss:0.07491331547498703 	 val_loss:0.29575052857398987
epoch:8/100 	 train_acc:99.34640502929688 	 val_acc:91.9565200805664 	 train_loss:0.07983949035406113 	 val_loss:0.23431536555290222
epoch:9/100 	 train_acc:99.61873626708984 	 val_acc:91.52173614501953 	 train_loss:0.09291768819093704 	 val_loss:0.22272594273090363
epoch:10/100 	 train_acc:99.50980377197266 	 val_acc:89.99999237060547 	 train_loss:0.0992162898182869 	 val_loss:0.24843953549861908
epoch:11/100 	 train_acc:99.61873626708984 	 val_acc:92.82608032226562 	 train_loss:0.0889960452914238 	 val_loss:0.16462010145187378
epoch:12/100 	 train_acc:99.89106750488281 	 val_acc:91.3043441772461 	 train_loss:0.036982461810112 	 val_loss:0.24997322261333466
epoch:13/100 	 train_acc:99.56427001953125 	 val_acc:91.73912811279297 	 train_loss:0.017188243567943573 	 val_loss:0.1735369712114334
epoch:14/100 	 train_acc:99.78213500976562 	 val_acc:91.73912811279297 	 train_loss:0.05058176442980766 	 val_loss:0.22581805288791656
epoch:15/100 	 train_acc:99.78213500976562 	 val_acc:92.39129638671875 	 train_loss:0.035487543791532516 	 val_loss:0.15001168847084045
epoch:16/100 	 train_acc:99.89106750488281 	 val_acc:91.3043441772461 	 train_loss:0.011035562492907047 	 val_loss:0.15620313584804535
epoch:17/100 	 train_acc:99.9455337524414 	 val_acc:91.9565200805664 	 train_loss:0.0176773052662611 	 val_loss:0.14379467070102692
epoch:18/100 	 train_acc:99.72766876220703 	 val_acc:92.39129638671875 	 train_loss:0.010849316604435444 	 val_loss:0.22072651982307434
epoch:19/100 	 train_acc:99.83660125732422 	 val_acc:92.82608032226562 	 train_loss:0.013752466067671776 	 val_loss:0.13037224113941193
epoch:20/100 	 train_acc:100.0 	 val_acc:92.17391204833984 	 train_loss:0.017001958563923836 	 val_loss:0.16365297138690948
epoch:21/100 	 train_acc:99.83660125732422 	 val_acc:92.17391204833984 	 train_loss:0.02358096092939377 	 val_loss:0.14856159687042236
epoch:22/100 	 train_acc:99.72766876220703 	 val_acc:91.9565200805664 	 train_loss:0.005662258248776197 	 val_loss:0.1618993580341339
epoch:23/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.003994881175458431 	 val_loss:0.17761695384979248
epoch:24/100 	 train_acc:99.89106750488281 	 val_acc:93.69564819335938 	 train_loss:0.007326532620936632 	 val_loss:0.16295190155506134
epoch:25/100 	 train_acc:99.83660125732422 	 val_acc:92.17391204833984 	 train_loss:0.006314336787909269 	 val_loss:0.16189217567443848
epoch:26/100 	 train_acc:99.83660125732422 	 val_acc:92.17391204833984 	 train_loss:0.002976001938804984 	 val_loss:0.1622806042432785
epoch:27/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.004399709403514862 	 val_loss:0.14681489765644073
epoch:28/100 	 train_acc:99.72766876220703 	 val_acc:92.60868835449219 	 train_loss:0.002091728849336505 	 val_loss:0.17446300387382507
epoch:29/100 	 train_acc:99.72766876220703 	 val_acc:93.04347229003906 	 train_loss:0.007276177406311035 	 val_loss:0.11704897880554199
epoch:30/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.006756608374416828 	 val_loss:0.10201725363731384
epoch:31/100 	 train_acc:99.78213500976562 	 val_acc:93.04347229003906 	 train_loss:0.0036298148334026337 	 val_loss:0.1472693532705307
epoch:32/100 	 train_acc:99.83660125732422 	 val_acc:93.2608642578125 	 train_loss:0.005958427209407091 	 val_loss:0.1780727207660675
epoch:33/100 	 train_acc:99.78213500976562 	 val_acc:93.69564819335938 	 train_loss:0.0028244738932698965 	 val_loss:0.20300821959972382
epoch:34/100 	 train_acc:99.72766876220703 	 val_acc:93.2608642578125 	 train_loss:0.001981742912903428 	 val_loss:0.19687865674495697
epoch:35/100 	 train_acc:99.78213500976562 	 val_acc:92.60868835449219 	 train_loss:0.002565324306488037 	 val_loss:0.23392115533351898
epoch:36/100 	 train_acc:99.89106750488281 	 val_acc:92.82608032226562 	 train_loss:0.001992523670196533 	 val_loss:0.15791380405426025
epoch:37/100 	 train_acc:99.67320251464844 	 val_acc:92.60868835449219 	 train_loss:0.027720682322978973 	 val_loss:0.14237630367279053
epoch:38/100 	 train_acc:99.83660125732422 	 val_acc:92.82608032226562 	 train_loss:0.017369123175740242 	 val_loss:0.20219296216964722
epoch:39/100 	 train_acc:99.78213500976562 	 val_acc:92.39129638671875 	 train_loss:0.00591597706079483 	 val_loss:0.24226805567741394
epoch:40/100 	 train_acc:99.83660125732422 	 val_acc:92.39129638671875 	 train_loss:0.0022144662216305733 	 val_loss:0.1785893589258194
epoch:41/100 	 train_acc:99.78213500976562 	 val_acc:94.13043212890625 	 train_loss:0.003919897601008415 	 val_loss:0.1105550080537796
epoch:42/100 	 train_acc:99.72766876220703 	 val_acc:93.04347229003906 	 train_loss:0.003791038878262043 	 val_loss:0.23561008274555206
epoch:43/100 	 train_acc:99.89106750488281 	 val_acc:92.60868835449219 	 train_loss:0.0027793205808848143 	 val_loss:0.12785585224628448
epoch:44/100 	 train_acc:99.72766876220703 	 val_acc:93.2608642578125 	 train_loss:0.002025267342105508 	 val_loss:0.09993520379066467
epoch:45/100 	 train_acc:99.78213500976562 	 val_acc:92.60868835449219 	 train_loss:0.003859121585264802 	 val_loss:0.19716916978359222
epoch:46/100 	 train_acc:99.83660125732422 	 val_acc:93.47825622558594 	 train_loss:0.015339243225753307 	 val_loss:0.12116675823926926
epoch:47/100 	 train_acc:99.83660125732422 	 val_acc:93.69564819335938 	 train_loss:0.0020719640888273716 	 val_loss:0.1520952731370926
epoch:48/100 	 train_acc:99.83660125732422 	 val_acc:92.82608032226562 	 train_loss:0.0011945971054956317 	 val_loss:0.1563490480184555
epoch:49/100 	 train_acc:99.72766876220703 	 val_acc:91.9565200805664 	 train_loss:0.012035226449370384 	 val_loss:0.15349718928337097
epoch:50/100 	 train_acc:99.72766876220703 	 val_acc:93.04347229003906 	 train_loss:0.02763071469962597 	 val_loss:0.17122924327850342
epoch:51/100 	 train_acc:99.72766876220703 	 val_acc:94.13043212890625 	 train_loss:0.003095445688813925 	 val_loss:0.2136494517326355
epoch:52/100 	 train_acc:99.89106750488281 	 val_acc:92.17391204833984 	 train_loss:0.007488960400223732 	 val_loss:0.17913030087947845
epoch:53/100 	 train_acc:99.78213500976562 	 val_acc:93.04347229003906 	 train_loss:0.008122590370476246 	 val_loss:0.17473183572292328
epoch:54/100 	 train_acc:99.78213500976562 	 val_acc:93.2608642578125 	 train_loss:0.0017757200403138995 	 val_loss:0.18374541401863098
epoch:55/100 	 train_acc:99.9455337524414 	 val_acc:93.04347229003906 	 train_loss:0.0008908067247830331 	 val_loss:0.19888782501220703
epoch:56/100 	 train_acc:99.83660125732422 	 val_acc:92.82608032226562 	 train_loss:0.0655967965722084 	 val_loss:0.17768092453479767
epoch:57/100 	 train_acc:99.83660125732422 	 val_acc:93.2608642578125 	 train_loss:0.0017710651736706495 	 val_loss:0.19287659227848053
epoch:58/100 	 train_acc:99.83660125732422 	 val_acc:93.2608642578125 	 train_loss:0.009909706190228462 	 val_loss:0.16305220127105713
epoch:59/100 	 train_acc:99.78213500976562 	 val_acc:93.47825622558594 	 train_loss:0.049530256539583206 	 val_loss:0.1291440725326538
epoch:60/100 	 train_acc:99.83660125732422 	 val_acc:92.82608032226562 	 train_loss:0.003068256890401244 	 val_loss:0.20626191794872284
epoch:61/100 	 train_acc:99.83660125732422 	 val_acc:92.60868835449219 	 train_loss:0.01840834505856037 	 val_loss:0.23467500507831573
epoch:62/100 	 train_acc:99.67320251464844 	 val_acc:91.9565200805664 	 train_loss:0.000763960531912744 	 val_loss:0.19096940755844116
epoch:63/100 	 train_acc:99.78213500976562 	 val_acc:92.82608032226562 	 train_loss:0.0024278732016682625 	 val_loss:0.10877303034067154
epoch:64/100 	 train_acc:99.9455337524414 	 val_acc:93.47825622558594 	 train_loss:0.002620466286316514 	 val_loss:0.15088561177253723
epoch:65/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.0013335964176803827 	 val_loss:0.18247926235198975
epoch:66/100 	 train_acc:99.67320251464844 	 val_acc:93.04347229003906 	 train_loss:0.0006458606221713126 	 val_loss:0.14517588913440704
epoch:67/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.0008239009766839445 	 val_loss:0.10960850119590759
epoch:68/100 	 train_acc:99.72766876220703 	 val_acc:92.60868835449219 	 train_loss:0.000651931157335639 	 val_loss:0.16603223979473114
epoch:69/100 	 train_acc:99.78213500976562 	 val_acc:93.69564819335938 	 train_loss:0.02417895197868347 	 val_loss:0.12023696303367615
epoch:70/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.0292247012257576 	 val_loss:0.18311665952205658
epoch:71/100 	 train_acc:99.89106750488281 	 val_acc:92.82608032226562 	 train_loss:0.033384665846824646 	 val_loss:0.19164511561393738
epoch:72/100 	 train_acc:99.78213500976562 	 val_acc:93.91304016113281 	 train_loss:0.008116930723190308 	 val_loss:0.1776989996433258
epoch:73/100 	 train_acc:99.83660125732422 	 val_acc:92.60868835449219 	 train_loss:0.009894084185361862 	 val_loss:0.15051062405109406
epoch:74/100 	 train_acc:99.78213500976562 	 val_acc:93.47825622558594 	 train_loss:0.0012215989409014583 	 val_loss:0.12406912446022034
epoch:75/100 	 train_acc:99.89106750488281 	 val_acc:93.2608642578125 	 train_loss:0.0016428581438958645 	 val_loss:0.11824967712163925
epoch:76/100 	 train_acc:99.78213500976562 	 val_acc:92.82608032226562 	 train_loss:0.004330662079155445 	 val_loss:0.18024641275405884
epoch:77/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.01969173364341259 	 val_loss:0.0922614112496376
epoch:78/100 	 train_acc:99.72766876220703 	 val_acc:94.34782409667969 	 train_loss:0.0012489393120631576 	 val_loss:0.08993123471736908
epoch:79/100 	 train_acc:99.83660125732422 	 val_acc:92.60868835449219 	 train_loss:0.0004806687356904149 	 val_loss:0.20613008737564087
epoch:80/100 	 train_acc:99.83660125732422 	 val_acc:93.47825622558594 	 train_loss:0.0014504798455163836 	 val_loss:0.16356608271598816
epoch:81/100 	 train_acc:99.89106750488281 	 val_acc:93.47825622558594 	 train_loss:0.0007053739973343909 	 val_loss:0.12999852001667023
epoch:82/100 	 train_acc:99.83660125732422 	 val_acc:94.34782409667969 	 train_loss:0.0005832979222759604 	 val_loss:0.14680495858192444
epoch:83/100 	 train_acc:99.89106750488281 	 val_acc:92.82608032226562 	 train_loss:0.001402069116011262 	 val_loss:0.152080699801445
epoch:84/100 	 train_acc:99.78213500976562 	 val_acc:92.39129638671875 	 train_loss:0.0004213642969261855 	 val_loss:0.1017613634467125
epoch:85/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.0010868946556001902 	 val_loss:0.1327867954969406
epoch:86/100 	 train_acc:99.9455337524414 	 val_acc:94.99999237060547 	 train_loss:0.0008227619691751897 	 val_loss:0.07882881164550781
epoch:87/100 	 train_acc:99.72766876220703 	 val_acc:94.34782409667969 	 train_loss:0.0004441681376192719 	 val_loss:0.1239347979426384
epoch:88/100 	 train_acc:99.78213500976562 	 val_acc:92.60868835449219 	 train_loss:0.018760843202471733 	 val_loss:0.19511941075325012
epoch:89/100 	 train_acc:99.78213500976562 	 val_acc:92.82608032226562 	 train_loss:0.031132711097598076 	 val_loss:0.1514318585395813
epoch:90/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.0006259049405343831 	 val_loss:0.16394728422164917
epoch:91/100 	 train_acc:99.83660125732422 	 val_acc:93.47825622558594 	 train_loss:0.007226666435599327 	 val_loss:0.11557910591363907
epoch:92/100 	 train_acc:99.72766876220703 	 val_acc:93.04347229003906 	 train_loss:0.0008937628590501845 	 val_loss:0.1543004959821701
epoch:93/100 	 train_acc:99.72766876220703 	 val_acc:91.52173614501953 	 train_loss:0.0007388326921500266 	 val_loss:0.2510053813457489
epoch:94/100 	 train_acc:99.78213500976562 	 val_acc:93.47825622558594 	 train_loss:0.0007559943478554487 	 val_loss:0.15769539773464203
epoch:95/100 	 train_acc:99.78213500976562 	 val_acc:92.82608032226562 	 train_loss:0.0185928363353014 	 val_loss:0.19084464013576508
epoch:96/100 	 train_acc:99.72766876220703 	 val_acc:93.2608642578125 	 train_loss:0.0017421834636479616 	 val_loss:0.120021291077137
epoch:97/100 	 train_acc:99.78213500976562 	 val_acc:93.2608642578125 	 train_loss:0.00027719675563275814 	 val_loss:0.15310528874397278
epoch:98/100 	 train_acc:99.72766876220703 	 val_acc:93.04347229003906 	 train_loss:0.013809851370751858 	 val_loss:0.24078617990016937
epoch:99/100 	 train_acc:99.61873626708984 	 val_acc:91.9565200805664 	 train_loss:0.01802668161690235 	 val_loss:0.22943174839019775
训练结束！