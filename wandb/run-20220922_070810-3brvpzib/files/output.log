C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
训练准备......
{'cardboard': 0, 'glass': 1, 'metal': 2, 'paper': 3, 'plastic': 4, 'trash': 5}
加载预训练模型
训练开始......
epoch:0/100 	 train_acc:63.671024322509766 	 val_acc:79.34782409667969 	 train_loss:0.6250913143157959 	 val_loss:0.5339735150337219
epoch:1/100 	 train_acc:87.63616180419922 	 val_acc:85.65216827392578 	 train_loss:0.45736807584762573 	 val_loss:0.44430476427078247
epoch:2/100 	 train_acc:93.13725280761719 	 val_acc:88.2608642578125 	 train_loss:0.20935049653053284 	 val_loss:0.27594754099845886
epoch:3/100 	 train_acc:97.00435638427734 	 val_acc:90.43477630615234 	 train_loss:0.13846158981323242 	 val_loss:0.28372442722320557
epoch:4/100 	 train_acc:98.03921508789062 	 val_acc:93.2608642578125 	 train_loss:0.06710225343704224 	 val_loss:0.22441068291664124
epoch:5/100 	 train_acc:99.0740737915039 	 val_acc:92.60868835449219 	 train_loss:0.06810348480939865 	 val_loss:0.20007774233818054
epoch:6/100 	 train_acc:99.34640502929688 	 val_acc:91.73912811279297 	 train_loss:0.02424924448132515 	 val_loss:0.1820182502269745
epoch:7/100 	 train_acc:99.56427001953125 	 val_acc:93.69564819335938 	 train_loss:0.048363689333200455 	 val_loss:0.18229281902313232
epoch:8/100 	 train_acc:99.45533752441406 	 val_acc:93.69564819335938 	 train_loss:0.10975911468267441 	 val_loss:0.15000571310520172
epoch:9/100 	 train_acc:99.72766876220703 	 val_acc:91.73912811279297 	 train_loss:0.016331741586327553 	 val_loss:0.20552639663219452
epoch:10/100 	 train_acc:99.78213500976562 	 val_acc:92.60868835449219 	 train_loss:0.011691611260175705 	 val_loss:0.17148369550704956
epoch:11/100 	 train_acc:99.83660125732422 	 val_acc:93.47825622558594 	 train_loss:0.007485513109713793 	 val_loss:0.15419013798236847
epoch:12/100 	 train_acc:99.67320251464844 	 val_acc:93.47825622558594 	 train_loss:0.09467320889234543 	 val_loss:0.21526703238487244
epoch:13/100 	 train_acc:99.89106750488281 	 val_acc:93.04347229003906 	 train_loss:0.011238709092140198 	 val_loss:0.15148615837097168
epoch:14/100 	 train_acc:99.9455337524414 	 val_acc:93.04347229003906 	 train_loss:0.014693045057356358 	 val_loss:0.2020500898361206
epoch:15/100 	 train_acc:99.89106750488281 	 val_acc:93.91304016113281 	 train_loss:0.01872052066028118 	 val_loss:0.1444137841463089
epoch:16/100 	 train_acc:99.89106750488281 	 val_acc:94.56521606445312 	 train_loss:0.0040219975635409355 	 val_loss:0.1307934820652008
epoch:17/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.004648167174309492 	 val_loss:0.18108180165290833
epoch:18/100 	 train_acc:99.9455337524414 	 val_acc:92.82608032226562 	 train_loss:0.0029225461184978485 	 val_loss:0.18136203289031982
epoch:19/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.006563242059201002 	 val_loss:0.1766335666179657
epoch:20/100 	 train_acc:100.0 	 val_acc:93.91304016113281 	 train_loss:0.004071303177624941 	 val_loss:0.1664552390575409
epoch:21/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.00589440343901515 	 val_loss:0.14554831385612488
epoch:22/100 	 train_acc:99.9455337524414 	 val_acc:92.82608032226562 	 train_loss:0.005540104582905769 	 val_loss:0.15358322858810425
epoch:23/100 	 train_acc:99.78213500976562 	 val_acc:91.9565200805664 	 train_loss:0.07473838329315186 	 val_loss:0.16478674113750458
epoch:24/100 	 train_acc:99.50980377197266 	 val_acc:88.04347229003906 	 train_loss:0.06532282382249832 	 val_loss:0.4082004725933075
epoch:25/100 	 train_acc:99.56427001953125 	 val_acc:90.86956024169922 	 train_loss:0.007348519284278154 	 val_loss:0.20071716606616974
epoch:26/100 	 train_acc:99.61873626708984 	 val_acc:92.17391204833984 	 train_loss:0.00692095048725605 	 val_loss:0.20753026008605957
epoch:27/100 	 train_acc:99.72766876220703 	 val_acc:92.17391204833984 	 train_loss:0.0054733119904994965 	 val_loss:0.22895824909210205
epoch:28/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.0037281697150319815 	 val_loss:0.2027195692062378
epoch:29/100 	 train_acc:99.9455337524414 	 val_acc:93.2608642578125 	 train_loss:0.008889853022992611 	 val_loss:0.20604605972766876
epoch:30/100 	 train_acc:99.9455337524414 	 val_acc:93.04347229003906 	 train_loss:0.002771486295387149 	 val_loss:0.18095248937606812
epoch:31/100 	 train_acc:99.9455337524414 	 val_acc:93.69564819335938 	 train_loss:0.00674018869176507 	 val_loss:0.1645691692829132
epoch:32/100 	 train_acc:99.9455337524414 	 val_acc:92.82608032226562 	 train_loss:0.00608832947909832 	 val_loss:0.18827170133590698
epoch:33/100 	 train_acc:99.9455337524414 	 val_acc:93.2608642578125 	 train_loss:0.001587631064467132 	 val_loss:0.20216943323612213
epoch:34/100 	 train_acc:99.89106750488281 	 val_acc:93.04347229003906 	 train_loss:0.0010138413636013865 	 val_loss:0.18954458832740784
epoch:35/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.003908158745616674 	 val_loss:0.19867859780788422
epoch:36/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.0010102259693667293 	 val_loss:0.1790018230676651
epoch:37/100 	 train_acc:99.9455337524414 	 val_acc:93.2608642578125 	 train_loss:0.002666823100298643 	 val_loss:0.21940527856349945
epoch:38/100 	 train_acc:100.0 	 val_acc:93.69564819335938 	 train_loss:0.002542545786127448 	 val_loss:0.16942042112350464
epoch:39/100 	 train_acc:99.9455337524414 	 val_acc:92.60868835449219 	 train_loss:0.003026351099833846 	 val_loss:0.1700962781906128
epoch:40/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.0017484209965914488 	 val_loss:0.247114360332489
epoch:41/100 	 train_acc:99.89106750488281 	 val_acc:92.82608032226562 	 train_loss:0.0040042344480752945 	 val_loss:0.2339029610157013
epoch:42/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.0017609228380024433 	 val_loss:0.21586652100086212
epoch:43/100 	 train_acc:99.89106750488281 	 val_acc:92.39129638671875 	 train_loss:0.0017234723782166839 	 val_loss:0.2317660003900528
epoch:44/100 	 train_acc:99.9455337524414 	 val_acc:94.78260803222656 	 train_loss:0.0007477632025256753 	 val_loss:0.24291279911994934
epoch:45/100 	 train_acc:99.89106750488281 	 val_acc:95.2173843383789 	 train_loss:0.00034605932887643576 	 val_loss:0.17017389833927155
epoch:46/100 	 train_acc:99.89106750488281 	 val_acc:93.47825622558594 	 train_loss:0.001438333187252283 	 val_loss:0.14445842802524567
epoch:47/100 	 train_acc:99.89106750488281 	 val_acc:93.47825622558594 	 train_loss:0.0029053573962301016 	 val_loss:0.13992522656917572
epoch:48/100 	 train_acc:99.9455337524414 	 val_acc:94.78260803222656 	 train_loss:0.0005916532827541232 	 val_loss:0.207980215549469
epoch:49/100 	 train_acc:99.9455337524414 	 val_acc:92.82608032226562 	 train_loss:0.001764373853802681 	 val_loss:0.19811980426311493
epoch:50/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.01913321763277054 	 val_loss:0.14106476306915283
epoch:51/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.0013802344910800457 	 val_loss:0.19442258775234222
epoch:52/100 	 train_acc:99.9455337524414 	 val_acc:92.60868835449219 	 train_loss:0.0008292896091006696 	 val_loss:0.22426795959472656
epoch:53/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.000929123954847455 	 val_loss:0.17786237597465515
epoch:54/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0008216826245188713 	 val_loss:0.20897746086120605
epoch:55/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.0012834146618843079 	 val_loss:0.23708508908748627
epoch:56/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.0005172403180040419 	 val_loss:0.1535753756761551
epoch:57/100 	 train_acc:99.9455337524414 	 val_acc:93.04347229003906 	 train_loss:0.001309546292759478 	 val_loss:0.26232147216796875
epoch:58/100 	 train_acc:99.89106750488281 	 val_acc:94.99999237060547 	 train_loss:0.000931935734115541 	 val_loss:0.2129453420639038
epoch:59/100 	 train_acc:99.9455337524414 	 val_acc:95.2173843383789 	 train_loss:0.0018215320305898786 	 val_loss:0.245374858379364
epoch:60/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.0012374487705528736 	 val_loss:0.22267799079418182
epoch:61/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.0029141635168343782 	 val_loss:0.17080894112586975
epoch:62/100 	 train_acc:100.0 	 val_acc:94.34782409667969 	 train_loss:0.0006617974722757936 	 val_loss:0.2204214334487915
epoch:63/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.00079963548341766 	 val_loss:0.15503744781017303
epoch:64/100 	 train_acc:99.9455337524414 	 val_acc:94.99999237060547 	 train_loss:0.0006996537558734417 	 val_loss:0.13441050052642822
epoch:65/100 	 train_acc:99.9455337524414 	 val_acc:93.69564819335938 	 train_loss:0.000537197629455477 	 val_loss:0.19685569405555725
epoch:66/100 	 train_acc:99.83660125732422 	 val_acc:93.91304016113281 	 train_loss:0.022648625075817108 	 val_loss:0.20504724979400635
epoch:67/100 	 train_acc:99.01960754394531 	 val_acc:89.56521606445312 	 train_loss:0.03352009877562523 	 val_loss:0.2831762731075287
epoch:68/100 	 train_acc:99.1830062866211 	 val_acc:90.86956024169922 	 train_loss:0.00958526972681284 	 val_loss:0.31421327590942383
epoch:69/100 	 train_acc:99.34640502929688 	 val_acc:89.13043212890625 	 train_loss:0.027208112180233 	 val_loss:0.31304797530174255
epoch:70/100 	 train_acc:99.1285400390625 	 val_acc:89.99999237060547 	 train_loss:0.059025343507528305 	 val_loss:0.3395513594150543
epoch:71/100 	 train_acc:99.40087127685547 	 val_acc:91.9565200805664 	 train_loss:0.08312119543552399 	 val_loss:0.33786991238594055
epoch:72/100 	 train_acc:99.1285400390625 	 val_acc:88.69564819335938 	 train_loss:0.005701339337974787 	 val_loss:0.366523414850235
epoch:73/100 	 train_acc:99.34640502929688 	 val_acc:90.86956024169922 	 train_loss:0.0009906248888000846 	 val_loss:0.3497237265110016
epoch:74/100 	 train_acc:99.29193878173828 	 val_acc:90.86956024169922 	 train_loss:0.012937015853822231 	 val_loss:0.356649786233902
epoch:75/100 	 train_acc:99.61873626708984 	 val_acc:93.91304016113281 	 train_loss:0.05879481881856918 	 val_loss:0.30414775013923645
epoch:76/100 	 train_acc:99.40087127685547 	 val_acc:84.99999237060547 	 train_loss:0.008563465438783169 	 val_loss:0.3853124678134918
epoch:77/100 	 train_acc:99.23747253417969 	 val_acc:91.3043441772461 	 train_loss:0.031434185802936554 	 val_loss:0.24894766509532928
epoch:78/100 	 train_acc:99.83660125732422 	 val_acc:91.9565200805664 	 train_loss:0.038888391107320786 	 val_loss:0.33581531047821045
epoch:79/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.006467573344707489 	 val_loss:0.25347501039505005
epoch:80/100 	 train_acc:99.83660125732422 	 val_acc:93.47825622558594 	 train_loss:0.0008282288908958435 	 val_loss:0.2993946075439453
epoch:81/100 	 train_acc:99.83660125732422 	 val_acc:93.04347229003906 	 train_loss:0.004146983847022057 	 val_loss:0.2641557455062866
epoch:82/100 	 train_acc:100.0 	 val_acc:93.2608642578125 	 train_loss:0.0021192459389567375 	 val_loss:0.3119894564151764
epoch:83/100 	 train_acc:99.9455337524414 	 val_acc:93.04347229003906 	 train_loss:0.02210063301026821 	 val_loss:0.27991628646850586
epoch:84/100 	 train_acc:99.78213500976562 	 val_acc:92.39129638671875 	 train_loss:0.022932637482881546 	 val_loss:0.18045884370803833
epoch:85/100 	 train_acc:99.89106750488281 	 val_acc:90.2173843383789 	 train_loss:0.008595023304224014 	 val_loss:0.3492818772792816
epoch:86/100 	 train_acc:99.83660125732422 	 val_acc:94.34782409667969 	 train_loss:0.0031822966411709785 	 val_loss:0.19534453749656677
epoch:87/100 	 train_acc:99.89106750488281 	 val_acc:92.82608032226562 	 train_loss:0.004488664213567972 	 val_loss:0.19246791303157806
epoch:88/100 	 train_acc:99.89106750488281 	 val_acc:92.82608032226562 	 train_loss:0.0009521094616502523 	 val_loss:0.2430192083120346
epoch:89/100 	 train_acc:99.89106750488281 	 val_acc:92.17391204833984 	 train_loss:0.001973274629563093 	 val_loss:0.2657746374607086
epoch:90/100 	 train_acc:99.89106750488281 	 val_acc:92.39129638671875 	 train_loss:0.007575746160000563 	 val_loss:0.3021863102912903
epoch:91/100 	 train_acc:99.9455337524414 	 val_acc:92.82608032226562 	 train_loss:0.0034514516592025757 	 val_loss:0.32287415862083435
epoch:92/100 	 train_acc:99.89106750488281 	 val_acc:93.2608642578125 	 train_loss:0.0008981419377960265 	 val_loss:0.2402629405260086
epoch:93/100 	 train_acc:99.9455337524414 	 val_acc:92.39129638671875 	 train_loss:0.0023572552017867565 	 val_loss:0.16282515227794647
epoch:94/100 	 train_acc:99.89106750488281 	 val_acc:92.60868835449219 	 train_loss:0.0038380594924092293 	 val_loss:0.2582016885280609
epoch:95/100 	 train_acc:99.9455337524414 	 val_acc:93.2608642578125 	 train_loss:0.00048627733485773206 	 val_loss:0.22525948286056519
epoch:96/100 	 train_acc:99.9455337524414 	 val_acc:93.2608642578125 	 train_loss:0.0011024796403944492 	 val_loss:0.25000008940696716
epoch:97/100 	 train_acc:99.9455337524414 	 val_acc:93.69564819335938 	 train_loss:0.00035364821087569 	 val_loss:0.19485706090927124
epoch:98/100 	 train_acc:100.0 	 val_acc:93.47825622558594 	 train_loss:0.00037596188485622406 	 val_loss:0.18126846849918365
epoch:99/100 	 train_acc:99.9455337524414 	 val_acc:92.60868835449219 	 train_loss:0.000912858231458813 	 val_loss:0.2851164937019348
训练结束！