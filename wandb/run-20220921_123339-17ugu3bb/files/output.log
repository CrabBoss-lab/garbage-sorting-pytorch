C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
训练准备......
{'cardboard': 0, 'glass': 1, 'metal': 2, 'paper': 3, 'plastic': 4, 'trash': 5}
加载预训练模型
训练开始......
epoch:0/100 	 train_acc:45.79962921142578 	 val_acc:72.4238052368164 	 train_loss:1.0687406063079834 	 val_loss:0.8769838213920593
epoch:1/100 	 train_acc:80.83385467529297 	 val_acc:79.82583618164062 	 train_loss:0.47261035442352295 	 val_loss:0.5960395336151123
epoch:2/100 	 train_acc:87.80335998535156 	 val_acc:82.43831634521484 	 train_loss:0.2727619409561157 	 val_loss:0.4193984568119049
epoch:3/100 	 train_acc:92.15930938720703 	 val_acc:87.95355224609375 	 train_loss:0.28572434186935425 	 val_loss:0.32974934577941895
epoch:4/100 	 train_acc:94.77287292480469 	 val_acc:88.09869384765625 	 train_loss:0.2887667417526245 	 val_loss:0.29759445786476135
epoch:5/100 	 train_acc:96.01742553710938 	 val_acc:89.25979614257812 	 train_loss:0.16547469794750214 	 val_loss:0.27802327275276184
epoch:6/100 	 train_acc:97.82202911376953 	 val_acc:90.27576446533203 	 train_loss:0.14124053716659546 	 val_loss:0.23902875185012817
epoch:7/100 	 train_acc:98.25762939453125 	 val_acc:90.71117401123047 	 train_loss:0.08560261130332947 	 val_loss:0.21149113774299622
epoch:8/100 	 train_acc:99.1910400390625 	 val_acc:91.72714233398438 	 train_loss:0.07134290039539337 	 val_loss:0.27415961027145386
epoch:9/100 	 train_acc:99.56440734863281 	 val_acc:90.5660400390625 	 train_loss:0.07754548639059067 	 val_loss:0.26272982358932495
epoch:10/100 	 train_acc:99.6888656616211 	 val_acc:91.00144958496094 	 train_loss:0.04183560237288475 	 val_loss:0.24834193289279938
epoch:11/100 	 train_acc:99.62664031982422 	 val_acc:91.58200073242188 	 train_loss:0.023767122998833656 	 val_loss:0.2513032853603363
epoch:12/100 	 train_acc:99.81331634521484 	 val_acc:92.59796905517578 	 train_loss:0.04025644063949585 	 val_loss:0.2525518834590912
epoch:13/100 	 train_acc:99.87554931640625 	 val_acc:92.16255187988281 	 train_loss:0.02873801253736019 	 val_loss:0.2731156051158905
epoch:14/100 	 train_acc:99.81331634521484 	 val_acc:91.87227630615234 	 train_loss:0.02214527130126953 	 val_loss:0.20884457230567932
epoch:15/100 	 train_acc:99.93777465820312 	 val_acc:92.30769348144531 	 train_loss:0.01945367082953453 	 val_loss:0.28245294094085693
epoch:16/100 	 train_acc:99.93777465820312 	 val_acc:92.16255187988281 	 train_loss:0.009145479649305344 	 val_loss:0.27674633264541626
epoch:17/100 	 train_acc:100.0 	 val_acc:93.03337860107422 	 train_loss:0.0076942117884755135 	 val_loss:0.3068079352378845
epoch:18/100 	 train_acc:99.93777465820312 	 val_acc:92.88824462890625 	 train_loss:0.011929644271731377 	 val_loss:0.2944404184818268
epoch:19/100 	 train_acc:100.0 	 val_acc:93.03337860107422 	 train_loss:0.010145992040634155 	 val_loss:0.29547396302223206
epoch:20/100 	 train_acc:100.0 	 val_acc:93.03337860107422 	 train_loss:0.008350946940481663 	 val_loss:0.2604101002216339
epoch:21/100 	 train_acc:99.87554931640625 	 val_acc:93.46879577636719 	 train_loss:0.005520235747098923 	 val_loss:0.25611555576324463
epoch:22/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.007125972770154476 	 val_loss:0.27101272344589233
epoch:23/100 	 train_acc:99.87554931640625 	 val_acc:92.30769348144531 	 train_loss:0.009635163471102715 	 val_loss:0.2601431906223297
epoch:24/100 	 train_acc:100.0 	 val_acc:92.59796905517578 	 train_loss:0.011216413229703903 	 val_loss:0.21831423044204712
epoch:25/100 	 train_acc:100.0 	 val_acc:93.17852020263672 	 train_loss:0.014708857983350754 	 val_loss:0.2588129937648773
epoch:26/100 	 train_acc:100.0 	 val_acc:92.74310302734375 	 train_loss:0.020560020580887794 	 val_loss:0.28538572788238525
epoch:27/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.004904816392809153 	 val_loss:0.2785094082355499
epoch:28/100 	 train_acc:99.87554931640625 	 val_acc:93.75907135009766 	 train_loss:0.004665701184421778 	 val_loss:0.23849236965179443
epoch:29/100 	 train_acc:99.87554931640625 	 val_acc:92.30769348144531 	 train_loss:0.005133982747793198 	 val_loss:0.26226896047592163
epoch:30/100 	 train_acc:99.93777465820312 	 val_acc:93.46879577636719 	 train_loss:0.004661881364881992 	 val_loss:0.30367523431777954
epoch:31/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.03915183246135712 	 val_loss:0.29051902890205383
epoch:32/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.010367576964199543 	 val_loss:0.2821712791919708
epoch:33/100 	 train_acc:99.87554931640625 	 val_acc:93.61392974853516 	 train_loss:0.002588316099718213 	 val_loss:0.2813253700733185
epoch:34/100 	 train_acc:99.93777465820312 	 val_acc:92.88824462890625 	 train_loss:0.007414939347654581 	 val_loss:0.20187270641326904
epoch:35/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.003361874260008335 	 val_loss:0.2503077983856201
epoch:36/100 	 train_acc:99.93777465820312 	 val_acc:93.75907135009766 	 train_loss:0.004488184582442045 	 val_loss:0.3088259696960449
epoch:37/100 	 train_acc:100.0 	 val_acc:92.59796905517578 	 train_loss:0.0017066060099750757 	 val_loss:0.3088604211807251
epoch:38/100 	 train_acc:99.87554931640625 	 val_acc:93.17852020263672 	 train_loss:0.0020697305444628 	 val_loss:0.329931378364563
epoch:39/100 	 train_acc:100.0 	 val_acc:92.88824462890625 	 train_loss:0.0018938740249723196 	 val_loss:0.24725188314914703
epoch:40/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.005490920040756464 	 val_loss:0.27907371520996094
epoch:41/100 	 train_acc:99.93777465820312 	 val_acc:92.88824462890625 	 train_loss:0.003383990842849016 	 val_loss:0.33633944392204285
epoch:42/100 	 train_acc:99.93777465820312 	 val_acc:92.74310302734375 	 train_loss:0.002481230301782489 	 val_loss:0.2207384556531906
epoch:43/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.0017362249782308936 	 val_loss:0.2835201621055603
epoch:44/100 	 train_acc:100.0 	 val_acc:92.59796905517578 	 train_loss:0.003898110706359148 	 val_loss:0.28879258036613464
epoch:45/100 	 train_acc:99.87554931640625 	 val_acc:92.30769348144531 	 train_loss:0.002423511818051338 	 val_loss:0.3285173177719116
epoch:46/100 	 train_acc:99.93777465820312 	 val_acc:93.17852020263672 	 train_loss:0.002128221793100238 	 val_loss:0.2567233443260193
epoch:47/100 	 train_acc:100.0 	 val_acc:93.03337860107422 	 train_loss:0.0017726517980918288 	 val_loss:0.28305381536483765
epoch:48/100 	 train_acc:99.87554931640625 	 val_acc:93.46879577636719 	 train_loss:0.0017419909127056599 	 val_loss:0.30009058117866516
epoch:49/100 	 train_acc:99.87554931640625 	 val_acc:93.90420532226562 	 train_loss:0.0008813503663986921 	 val_loss:0.22348898649215698
epoch:50/100 	 train_acc:99.87554931640625 	 val_acc:93.17852020263672 	 train_loss:0.0012751524336636066 	 val_loss:0.33754807710647583
epoch:51/100 	 train_acc:99.93777465820312 	 val_acc:92.16255187988281 	 train_loss:0.0010559078073129058 	 val_loss:0.3377506136894226
epoch:52/100 	 train_acc:99.87554931640625 	 val_acc:92.88824462890625 	 train_loss:0.0018999906023964286 	 val_loss:0.28379693627357483
epoch:53/100 	 train_acc:99.93777465820312 	 val_acc:92.45282745361328 	 train_loss:0.0024035731330513954 	 val_loss:0.2860356867313385
epoch:54/100 	 train_acc:99.93777465820312 	 val_acc:92.59796905517578 	 train_loss:0.0017538892570883036 	 val_loss:0.2962154448032379
epoch:55/100 	 train_acc:99.93777465820312 	 val_acc:93.46879577636719 	 train_loss:0.0011285492219030857 	 val_loss:0.23035229742527008
epoch:56/100 	 train_acc:99.87554931640625 	 val_acc:92.88824462890625 	 train_loss:0.0019484220538288355 	 val_loss:0.2724740505218506
epoch:57/100 	 train_acc:99.93777465820312 	 val_acc:92.74310302734375 	 train_loss:0.0015420218696817756 	 val_loss:0.2927323579788208
epoch:58/100 	 train_acc:99.93777465820312 	 val_acc:93.17852020263672 	 train_loss:0.0016215199138969183 	 val_loss:0.25282713770866394
epoch:59/100 	 train_acc:99.93777465820312 	 val_acc:93.61392974853516 	 train_loss:0.0008692372357472777 	 val_loss:0.2953174114227295
epoch:60/100 	 train_acc:99.87554931640625 	 val_acc:93.32365417480469 	 train_loss:0.0024507290218025446 	 val_loss:0.20391406118869781
epoch:61/100 	 train_acc:99.87554931640625 	 val_acc:93.03337860107422 	 train_loss:0.0007639455725438893 	 val_loss:0.3465768098831177
epoch:62/100 	 train_acc:99.93777465820312 	 val_acc:93.75907135009766 	 train_loss:0.00088938616681844 	 val_loss:0.2883836030960083
epoch:63/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.0009274999029003084 	 val_loss:0.35883715748786926
epoch:64/100 	 train_acc:99.87554931640625 	 val_acc:92.16255187988281 	 train_loss:0.0011180872097611427 	 val_loss:0.3112621009349823
epoch:65/100 	 train_acc:99.93777465820312 	 val_acc:92.74310302734375 	 train_loss:0.001263530575670302 	 val_loss:0.26884984970092773
epoch:66/100 	 train_acc:99.93777465820312 	 val_acc:92.74310302734375 	 train_loss:0.001284606521949172 	 val_loss:0.26392602920532227
epoch:67/100 	 train_acc:99.87554931640625 	 val_acc:93.17852020263672 	 train_loss:0.0007431282429024577 	 val_loss:0.19332320988178253
epoch:68/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.002627169480547309 	 val_loss:0.29492005705833435
epoch:69/100 	 train_acc:99.93777465820312 	 val_acc:93.61392974853516 	 train_loss:0.0024913994129747152 	 val_loss:0.3194228410720825
epoch:70/100 	 train_acc:100.0 	 val_acc:92.74310302734375 	 train_loss:0.011345128528773785 	 val_loss:0.29435795545578003
epoch:71/100 	 train_acc:99.81331634521484 	 val_acc:92.74310302734375 	 train_loss:0.0018099651206284761 	 val_loss:0.2909689247608185
epoch:72/100 	 train_acc:99.93777465820312 	 val_acc:91.87227630615234 	 train_loss:0.0008731481502763927 	 val_loss:0.31754425168037415
epoch:73/100 	 train_acc:99.87554931640625 	 val_acc:92.30769348144531 	 train_loss:0.0020716951694339514 	 val_loss:0.22533288598060608
epoch:74/100 	 train_acc:99.87554931640625 	 val_acc:92.88824462890625 	 train_loss:0.0010782884201034904 	 val_loss:0.3444425165653229
epoch:75/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.002947914181277156 	 val_loss:0.2312568724155426
epoch:76/100 	 train_acc:99.87554931640625 	 val_acc:92.88824462890625 	 train_loss:0.004771870095282793 	 val_loss:0.3271252512931824
epoch:77/100 	 train_acc:99.93777465820312 	 val_acc:93.46879577636719 	 train_loss:0.0005663008778356016 	 val_loss:0.2539549469947815
epoch:78/100 	 train_acc:99.93777465820312 	 val_acc:92.74310302734375 	 train_loss:0.0009044231264851987 	 val_loss:0.3215373456478119
epoch:79/100 	 train_acc:99.93777465820312 	 val_acc:92.88824462890625 	 train_loss:0.0015228546690195799 	 val_loss:0.27593594789505005
epoch:80/100 	 train_acc:99.93777465820312 	 val_acc:93.32365417480469 	 train_loss:0.0010258115362375975 	 val_loss:0.3232586085796356
epoch:81/100 	 train_acc:99.93777465820312 	 val_acc:93.17852020263672 	 train_loss:0.008906802162528038 	 val_loss:0.31265023350715637
epoch:82/100 	 train_acc:99.93777465820312 	 val_acc:93.75907135009766 	 train_loss:0.008189871907234192 	 val_loss:0.2695118486881256
epoch:83/100 	 train_acc:99.93777465820312 	 val_acc:93.03337860107422 	 train_loss:0.02012476697564125 	 val_loss:0.24737344682216644
epoch:84/100 	 train_acc:99.93777465820312 	 val_acc:92.30769348144531 	 train_loss:0.0005620960728265345 	 val_loss:0.28111517429351807
epoch:85/100 	 train_acc:99.93777465820312 	 val_acc:93.46879577636719 	 train_loss:0.0013365288032218814 	 val_loss:0.2707459330558777
epoch:86/100 	 train_acc:99.93777465820312 	 val_acc:92.88824462890625 	 train_loss:0.0009626070386730134 	 val_loss:0.22088998556137085
epoch:87/100 	 train_acc:100.0 	 val_acc:92.74310302734375 	 train_loss:0.0008482544799335301 	 val_loss:0.331859290599823
epoch:88/100 	 train_acc:100.0 	 val_acc:92.88824462890625 	 train_loss:0.0007516334881074727 	 val_loss:0.3116646707057953
epoch:89/100 	 train_acc:100.0 	 val_acc:93.03337860107422 	 train_loss:0.0006183570949360728 	 val_loss:0.3533618748188019
epoch:90/100 	 train_acc:99.93777465820312 	 val_acc:93.17852020263672 	 train_loss:0.0007745139882899821 	 val_loss:0.2863559424877167
epoch:91/100 	 train_acc:99.87554931640625 	 val_acc:93.03337860107422 	 train_loss:0.0010293835075572133 	 val_loss:0.27725929021835327
epoch:92/100 	 train_acc:99.93777465820312 	 val_acc:93.46879577636719 	 train_loss:0.00045505844173021615 	 val_loss:0.26071253418922424
epoch:93/100 	 train_acc:99.93777465820312 	 val_acc:92.88824462890625 	 train_loss:0.0007412585546262562 	 val_loss:0.22890567779541016
epoch:94/100 	 train_acc:99.93777465820312 	 val_acc:92.59796905517578 	 train_loss:0.0005954111111350358 	 val_loss:0.3430337607860565
epoch:95/100 	 train_acc:99.93777465820312 	 val_acc:94.04934692382812 	 train_loss:0.0003710259625222534 	 val_loss:0.3458082973957062
epoch:96/100 	 train_acc:100.0 	 val_acc:93.32365417480469 	 train_loss:0.0009278283687308431 	 val_loss:0.2577837407588959
epoch:97/100 	 train_acc:99.93777465820312 	 val_acc:93.17852020263672 	 train_loss:0.0009717092616483569 	 val_loss:0.2631130814552307
epoch:98/100 	 train_acc:100.0 	 val_acc:93.17852020263672 	 train_loss:0.0010927817784249783 	 val_loss:0.3072541058063507
epoch:99/100 	 train_acc:99.87554931640625 	 val_acc:93.61392974853516 	 train_loss:0.0007119433139450848 	 val_loss:0.2622239589691162
训练结束！