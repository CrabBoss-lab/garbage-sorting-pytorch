C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
训练准备......
{'cardboard': 0, 'glass': 1, 'metal': 2, 'paper': 3, 'plastic': 4, 'trash': 5}
加载预训练模型
训练开始......
epoch:0/100 	 train_acc:48.78656005859375 	 val_acc:71.26270294189453 	 train_loss:0.8240558505058289 	 val_loss:0.9093315005302429
epoch:1/100 	 train_acc:81.39390563964844 	 val_acc:79.9709701538086 	 train_loss:0.7613736987113953 	 val_loss:0.637128472328186
epoch:2/100 	 train_acc:88.79900360107422 	 val_acc:85.05079650878906 	 train_loss:0.40809741616249084 	 val_loss:0.5637871623039246
epoch:3/100 	 train_acc:92.6571273803711 	 val_acc:85.63134765625 	 train_loss:0.24118828773498535 	 val_loss:0.49542927742004395
epoch:4/100 	 train_acc:95.27069091796875 	 val_acc:87.37300109863281 	 train_loss:0.1739347279071808 	 val_loss:0.4500826597213745
epoch:5/100 	 train_acc:97.32421112060547 	 val_acc:88.53410339355469 	 train_loss:0.12116552889347076 	 val_loss:0.416925847530365
epoch:6/100 	 train_acc:98.00871276855469 	 val_acc:89.6952133178711 	 train_loss:0.0899336040019989 	 val_loss:0.4128433167934418
epoch:7/100 	 train_acc:98.81767272949219 	 val_acc:89.11466217041016 	 train_loss:0.06570760905742645 	 val_loss:0.43695807456970215
epoch:8/100 	 train_acc:99.2532730102539 	 val_acc:90.13062286376953 	 train_loss:0.07318287342786789 	 val_loss:0.3939909338951111
epoch:9/100 	 train_acc:99.6888656616211 	 val_acc:90.13062286376953 	 train_loss:0.03730448707938194 	 val_loss:0.4426618218421936
epoch:10/100 	 train_acc:99.6888656616211 	 val_acc:89.84034729003906 	 train_loss:0.04322047904133797 	 val_loss:0.3773941099643707
epoch:11/100 	 train_acc:99.81331634521484 	 val_acc:90.27576446533203 	 train_loss:0.03303090110421181 	 val_loss:0.3747689723968506
epoch:12/100 	 train_acc:99.6888656616211 	 val_acc:90.13062286376953 	 train_loss:0.023839209228754044 	 val_loss:0.40894436836242676
epoch:13/100 	 train_acc:99.93777465820312 	 val_acc:90.71117401123047 	 train_loss:0.016551315784454346 	 val_loss:0.40125390887260437
epoch:14/100 	 train_acc:99.93777465820312 	 val_acc:89.98548889160156 	 train_loss:0.012528352439403534 	 val_loss:0.4254413843154907
epoch:15/100 	 train_acc:99.93777465820312 	 val_acc:90.4208984375 	 train_loss:0.007866758853197098 	 val_loss:0.4360581934452057
epoch:16/100 	 train_acc:100.0 	 val_acc:90.71117401123047 	 train_loss:0.012349389493465424 	 val_loss:0.4773935079574585
epoch:17/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.012316979467868805 	 val_loss:0.4430556297302246
epoch:18/100 	 train_acc:100.0 	 val_acc:90.85631561279297 	 train_loss:0.00785568356513977 	 val_loss:0.4866398870944977
epoch:19/100 	 train_acc:100.0 	 val_acc:90.85631561279297 	 train_loss:0.006022076588124037 	 val_loss:0.37226131558418274
epoch:20/100 	 train_acc:100.0 	 val_acc:90.4208984375 	 train_loss:0.005235203541815281 	 val_loss:0.41375601291656494
epoch:21/100 	 train_acc:100.0 	 val_acc:90.85631561279297 	 train_loss:0.007221462670713663 	 val_loss:0.3959175944328308
epoch:22/100 	 train_acc:100.0 	 val_acc:91.87227630615234 	 train_loss:0.007253359071910381 	 val_loss:0.4525211453437805
epoch:23/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.0039307186380028725 	 val_loss:0.4462699592113495
epoch:24/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.028110291808843613 	 val_loss:0.5283458232879639
epoch:25/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.00437798909842968 	 val_loss:0.4460580348968506
epoch:26/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.006132250651717186 	 val_loss:0.4366516172885895
epoch:27/100 	 train_acc:100.0 	 val_acc:90.71117401123047 	 train_loss:0.0033242518547922373 	 val_loss:0.5217195749282837
epoch:28/100 	 train_acc:100.0 	 val_acc:90.71117401123047 	 train_loss:0.006306045688688755 	 val_loss:0.5783801674842834
epoch:29/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.0027805319987237453 	 val_loss:0.4310530126094818
epoch:30/100 	 train_acc:100.0 	 val_acc:91.00144958496094 	 train_loss:0.003811795962974429 	 val_loss:0.46374985575675964
epoch:31/100 	 train_acc:100.0 	 val_acc:90.4208984375 	 train_loss:0.0036378675140440464 	 val_loss:0.37862956523895264
epoch:32/100 	 train_acc:100.0 	 val_acc:90.71117401123047 	 train_loss:0.005311670247465372 	 val_loss:0.4679884612560272
epoch:33/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.007518332451581955 	 val_loss:0.5128934383392334
epoch:34/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.004160948097705841 	 val_loss:0.38892698287963867
epoch:35/100 	 train_acc:100.0 	 val_acc:91.00144958496094 	 train_loss:0.013050608336925507 	 val_loss:0.4510057866573334
epoch:36/100 	 train_acc:100.0 	 val_acc:90.5660400390625 	 train_loss:0.0018694641767069697 	 val_loss:0.5620840191841125
epoch:37/100 	 train_acc:100.0 	 val_acc:90.85631561279297 	 train_loss:0.00324910506606102 	 val_loss:0.3838089108467102
epoch:38/100 	 train_acc:100.0 	 val_acc:91.00144958496094 	 train_loss:0.003141669789329171 	 val_loss:0.4606279730796814
epoch:39/100 	 train_acc:100.0 	 val_acc:92.01741790771484 	 train_loss:0.0017563930014148355 	 val_loss:0.535713791847229
epoch:40/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.001840297831222415 	 val_loss:0.4940919280052185
epoch:41/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.0025804995093494654 	 val_loss:0.5219510197639465
epoch:42/100 	 train_acc:100.0 	 val_acc:92.30769348144531 	 train_loss:0.002167112659662962 	 val_loss:0.4756319224834442
epoch:43/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.0012570697581395507 	 val_loss:0.5078868269920349
epoch:44/100 	 train_acc:100.0 	 val_acc:92.01741790771484 	 train_loss:0.0012899494031444192 	 val_loss:0.40314191579818726
epoch:45/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.0020175157114863396 	 val_loss:0.5311900973320007
epoch:46/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.001463954453356564 	 val_loss:0.45135146379470825
epoch:47/100 	 train_acc:100.0 	 val_acc:91.87227630615234 	 train_loss:0.002913875738158822 	 val_loss:0.4414348900318146
epoch:48/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.0009865618776530027 	 val_loss:0.5119338035583496
epoch:49/100 	 train_acc:100.0 	 val_acc:91.2917251586914 	 train_loss:0.0016920346533879638 	 val_loss:0.4595199227333069
epoch:50/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.002716609975323081 	 val_loss:0.4672192633152008
epoch:51/100 	 train_acc:100.0 	 val_acc:91.87227630615234 	 train_loss:0.0016066458774730563 	 val_loss:0.4116607904434204
epoch:52/100 	 train_acc:100.0 	 val_acc:90.85631561279297 	 train_loss:0.0014579062117263675 	 val_loss:0.4435847997665405
epoch:53/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.0014947318704798818 	 val_loss:0.49228835105895996
epoch:54/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.0014165048487484455 	 val_loss:0.5128371715545654
epoch:55/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.0012399394763633609 	 val_loss:0.4678407311439514
epoch:56/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.0008218380971811712 	 val_loss:0.46142205595970154
epoch:57/100 	 train_acc:100.0 	 val_acc:91.87227630615234 	 train_loss:0.00179172249045223 	 val_loss:0.4672106206417084
epoch:58/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.001232067123055458 	 val_loss:0.4869338572025299
epoch:59/100 	 train_acc:100.0 	 val_acc:91.00144958496094 	 train_loss:0.0008652147371321917 	 val_loss:0.5584558248519897
epoch:60/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.0011151984799653292 	 val_loss:0.4525512754917145
epoch:61/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.0007866221712902188 	 val_loss:0.4868681728839874
epoch:62/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.0007614076603204012 	 val_loss:0.5201503038406372
epoch:63/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.0005505815497599542 	 val_loss:0.5782883167266846
epoch:64/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.0025563263334333897 	 val_loss:0.5595471262931824
epoch:65/100 	 train_acc:100.0 	 val_acc:92.59796905517578 	 train_loss:0.0010334202088415623 	 val_loss:0.529313862323761
epoch:66/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.0007851664558984339 	 val_loss:0.4656490683555603
epoch:67/100 	 train_acc:100.0 	 val_acc:91.14659118652344 	 train_loss:0.002146457089111209 	 val_loss:0.5132817029953003
epoch:68/100 	 train_acc:100.0 	 val_acc:91.87227630615234 	 train_loss:0.0013464322546496987 	 val_loss:0.5785006284713745
epoch:69/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.00041321091703139246 	 val_loss:0.538734495639801
epoch:70/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.000721227377653122 	 val_loss:0.4935930669307709
epoch:71/100 	 train_acc:100.0 	 val_acc:91.87227630615234 	 train_loss:0.0008223755867220461 	 val_loss:0.5212597846984863
epoch:72/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.0005357783520594239 	 val_loss:0.44681140780448914
epoch:73/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.0005291723646223545 	 val_loss:0.5087680816650391
epoch:74/100 	 train_acc:100.0 	 val_acc:90.85631561279297 	 train_loss:0.0005745061207562685 	 val_loss:0.44437381625175476
epoch:75/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.001264051184989512 	 val_loss:0.48064830899238586
epoch:76/100 	 train_acc:100.0 	 val_acc:91.2917251586914 	 train_loss:0.0005599588039331138 	 val_loss:0.5012352466583252
epoch:77/100 	 train_acc:100.0 	 val_acc:91.00144958496094 	 train_loss:0.0003769758332055062 	 val_loss:0.5868874192237854
epoch:78/100 	 train_acc:100.0 	 val_acc:90.71117401123047 	 train_loss:0.0005425367853604257 	 val_loss:0.5565661787986755
epoch:79/100 	 train_acc:100.0 	 val_acc:91.00144958496094 	 train_loss:0.0006733332993462682 	 val_loss:0.5493532419204712
epoch:80/100 	 train_acc:100.0 	 val_acc:91.2917251586914 	 train_loss:0.0016205733409151435 	 val_loss:0.5118080973625183
epoch:81/100 	 train_acc:100.0 	 val_acc:92.01741790771484 	 train_loss:0.0006637778715230525 	 val_loss:0.4504269063472748
epoch:82/100 	 train_acc:100.0 	 val_acc:92.59796905517578 	 train_loss:0.0005087474128231406 	 val_loss:0.5040643215179443
epoch:83/100 	 train_acc:100.0 	 val_acc:92.01741790771484 	 train_loss:0.0007584129343740642 	 val_loss:0.5434094667434692
epoch:84/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.0009387444006279111 	 val_loss:0.4896683692932129
epoch:85/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.0005623188917525113 	 val_loss:0.5276209115982056
epoch:86/100 	 train_acc:100.0 	 val_acc:92.01741790771484 	 train_loss:0.0008439791272394359 	 val_loss:0.5911673903465271
epoch:87/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.0005316675524227321 	 val_loss:0.5870758891105652
epoch:88/100 	 train_acc:100.0 	 val_acc:91.4368667602539 	 train_loss:0.0007764229667373002 	 val_loss:0.5683652758598328
epoch:89/100 	 train_acc:100.0 	 val_acc:92.74310302734375 	 train_loss:0.00034699292154982686 	 val_loss:0.5650337934494019
epoch:90/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.00032022985396906734 	 val_loss:0.5610734820365906
epoch:91/100 	 train_acc:100.0 	 val_acc:91.72714233398438 	 train_loss:0.00045038823736831546 	 val_loss:0.4305475652217865
epoch:92/100 	 train_acc:100.0 	 val_acc:91.2917251586914 	 train_loss:0.0005023955018259585 	 val_loss:0.5379642844200134
epoch:93/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.00044073842582292855 	 val_loss:0.4542463719844818
epoch:94/100 	 train_acc:100.0 	 val_acc:92.16255187988281 	 train_loss:0.0006218645139597356 	 val_loss:0.5502879023551941
epoch:95/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.0003012109955307096 	 val_loss:0.4949989318847656
epoch:96/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.000534442369826138 	 val_loss:0.4970342814922333
epoch:97/100 	 train_acc:100.0 	 val_acc:92.30769348144531 	 train_loss:0.00048614011029712856 	 val_loss:0.46305030584335327
epoch:98/100 	 train_acc:100.0 	 val_acc:92.45282745361328 	 train_loss:0.00031835935078561306 	 val_loss:0.5110079050064087
epoch:99/100 	 train_acc:100.0 	 val_acc:91.58200073242188 	 train_loss:0.0004133800102863461 	 val_loss:0.5782113075256348
训练结束！