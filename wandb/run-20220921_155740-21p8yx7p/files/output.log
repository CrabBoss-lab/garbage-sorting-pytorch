C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
C:\Users\yujunyu\.conda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
训练准备......
{'cardboard': 0, 'glass': 1, 'metal': 2, 'paper': 3, 'plastic': 4, 'trash': 5}
加载预训练模型
训练开始......
epoch:0/100 	 train_acc:52.39651107788086 	 val_acc:74.78260803222656 	 train_loss:0.8874574899673462 	 val_loss:0.8210588693618774
epoch:1/100 	 train_acc:82.46186828613281 	 val_acc:84.34782409667969 	 train_loss:0.5878341197967529 	 val_loss:0.5485920906066895
epoch:2/100 	 train_acc:88.45315551757812 	 val_acc:87.82608032226562 	 train_loss:0.4797182083129883 	 val_loss:0.42841359972953796
epoch:3/100 	 train_acc:92.59259033203125 	 val_acc:89.13043212890625 	 train_loss:0.4461424946784973 	 val_loss:0.3435478210449219
epoch:4/100 	 train_acc:95.09803771972656 	 val_acc:91.08695220947266 	 train_loss:0.13794054090976715 	 val_loss:0.3028174340724945
epoch:5/100 	 train_acc:96.94989013671875 	 val_acc:91.9565200805664 	 train_loss:0.1280437856912613 	 val_loss:0.24161599576473236
epoch:6/100 	 train_acc:97.82135009765625 	 val_acc:92.39129638671875 	 train_loss:0.1333262026309967 	 val_loss:0.256418377161026
epoch:7/100 	 train_acc:98.63834381103516 	 val_acc:93.47825622558594 	 train_loss:0.06929311901330948 	 val_loss:0.249064639210701
epoch:8/100 	 train_acc:99.1285400390625 	 val_acc:92.60868835449219 	 train_loss:0.11305426806211472 	 val_loss:0.2247384786605835
epoch:9/100 	 train_acc:99.45533752441406 	 val_acc:93.47825622558594 	 train_loss:0.03862697258591652 	 val_loss:0.18249426782131195
epoch:10/100 	 train_acc:99.56427001953125 	 val_acc:92.60868835449219 	 train_loss:0.029331626370549202 	 val_loss:0.19667065143585205
epoch:11/100 	 train_acc:99.78213500976562 	 val_acc:94.34782409667969 	 train_loss:0.03703548014163971 	 val_loss:0.15031462907791138
epoch:12/100 	 train_acc:99.89106750488281 	 val_acc:93.91304016113281 	 train_loss:0.015470809303224087 	 val_loss:0.19520790874958038
epoch:13/100 	 train_acc:99.83660125732422 	 val_acc:93.91304016113281 	 train_loss:0.04889576509594917 	 val_loss:0.16713152825832367
epoch:14/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.010576843284070492 	 val_loss:0.14933960139751434
epoch:15/100 	 train_acc:100.0 	 val_acc:93.91304016113281 	 train_loss:0.014787121675908566 	 val_loss:0.20030604302883148
epoch:16/100 	 train_acc:99.83660125732422 	 val_acc:93.69564819335938 	 train_loss:0.09752161055803299 	 val_loss:0.19802439212799072
epoch:17/100 	 train_acc:99.83660125732422 	 val_acc:93.91304016113281 	 train_loss:0.01630488783121109 	 val_loss:0.16427667438983917
epoch:18/100 	 train_acc:99.83660125732422 	 val_acc:92.82608032226562 	 train_loss:0.01804317906498909 	 val_loss:0.19263312220573425
epoch:19/100 	 train_acc:99.9455337524414 	 val_acc:94.99999237060547 	 train_loss:0.007108697202056646 	 val_loss:0.12063862383365631
epoch:20/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.00634748162701726 	 val_loss:0.16067150235176086
epoch:21/100 	 train_acc:100.0 	 val_acc:94.13043212890625 	 train_loss:0.012028571218252182 	 val_loss:0.17445209622383118
epoch:22/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.0063137453980743885 	 val_loss:0.19730150699615479
epoch:23/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.009562893770635128 	 val_loss:0.14401763677597046
epoch:24/100 	 train_acc:100.0 	 val_acc:93.91304016113281 	 train_loss:0.009977471083402634 	 val_loss:0.16923902928829193
epoch:25/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.017066707834601402 	 val_loss:0.13172288239002228
epoch:26/100 	 train_acc:100.0 	 val_acc:94.13043212890625 	 train_loss:0.006121922750025988 	 val_loss:0.15733473002910614
epoch:27/100 	 train_acc:99.89106750488281 	 val_acc:93.91304016113281 	 train_loss:0.007795545272529125 	 val_loss:0.21140344440937042
epoch:28/100 	 train_acc:99.89106750488281 	 val_acc:93.47825622558594 	 train_loss:0.005629019811749458 	 val_loss:0.1728878915309906
epoch:29/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.004014588426798582 	 val_loss:0.1576356589794159
epoch:30/100 	 train_acc:99.89106750488281 	 val_acc:93.69564819335938 	 train_loss:0.007258910220116377 	 val_loss:0.1936485767364502
epoch:31/100 	 train_acc:99.89106750488281 	 val_acc:93.91304016113281 	 train_loss:0.002135869348421693 	 val_loss:0.1331082582473755
epoch:32/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.0035630108322948217 	 val_loss:0.09190832823514938
epoch:33/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0029365664813667536 	 val_loss:0.13208864629268646
epoch:34/100 	 train_acc:99.9455337524414 	 val_acc:93.69564819335938 	 train_loss:0.006390620954334736 	 val_loss:0.2118287831544876
epoch:35/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.0027109647635370493 	 val_loss:0.15473759174346924
epoch:36/100 	 train_acc:100.0 	 val_acc:93.2608642578125 	 train_loss:0.002044104039669037 	 val_loss:0.16916759312152863
epoch:37/100 	 train_acc:100.0 	 val_acc:94.34782409667969 	 train_loss:0.0036189185921102762 	 val_loss:0.07793489843606949
epoch:38/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.006821532268077135 	 val_loss:0.14804676175117493
epoch:39/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.022974280640482903 	 val_loss:0.13650323450565338
epoch:40/100 	 train_acc:100.0 	 val_acc:93.91304016113281 	 train_loss:0.00561228534206748 	 val_loss:0.10233696550130844
epoch:41/100 	 train_acc:99.9455337524414 	 val_acc:93.47825622558594 	 train_loss:0.0027510575018823147 	 val_loss:0.13940738141536713
epoch:42/100 	 train_acc:99.9455337524414 	 val_acc:94.78260803222656 	 train_loss:0.0037409455981105566 	 val_loss:0.10275626182556152
epoch:43/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.0033060675486922264 	 val_loss:0.12198977917432785
epoch:44/100 	 train_acc:99.89106750488281 	 val_acc:94.56521606445312 	 train_loss:0.00452956510707736 	 val_loss:0.15226852893829346
epoch:45/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0011213695397600532 	 val_loss:0.0846116691827774
epoch:46/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.00606983108446002 	 val_loss:0.1449844390153885
epoch:47/100 	 train_acc:100.0 	 val_acc:93.47825622558594 	 train_loss:0.0013161123497411609 	 val_loss:0.14929558336734772
epoch:48/100 	 train_acc:99.89106750488281 	 val_acc:93.91304016113281 	 train_loss:0.0008473934722132981 	 val_loss:0.16752386093139648
epoch:49/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.001744299428537488 	 val_loss:0.1387861967086792
epoch:50/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.0025291189085692167 	 val_loss:0.15550069510936737
epoch:51/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.00474933348596096 	 val_loss:0.13675875961780548
epoch:52/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.002904505468904972 	 val_loss:0.16710643470287323
epoch:53/100 	 train_acc:99.89106750488281 	 val_acc:94.99999237060547 	 train_loss:0.0014208308421075344 	 val_loss:0.15701569616794586
epoch:54/100 	 train_acc:100.0 	 val_acc:95.2173843383789 	 train_loss:0.0036860122345387936 	 val_loss:0.1143878623843193
epoch:55/100 	 train_acc:99.9455337524414 	 val_acc:93.2608642578125 	 train_loss:0.0013089703861624002 	 val_loss:0.1360204666852951
epoch:56/100 	 train_acc:99.89106750488281 	 val_acc:94.99999237060547 	 train_loss:0.0029069960583001375 	 val_loss:0.12308351695537567
epoch:57/100 	 train_acc:99.9455337524414 	 val_acc:94.99999237060547 	 train_loss:0.0015114826383069158 	 val_loss:0.15571638941764832
epoch:58/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.001365691889077425 	 val_loss:0.11975517868995667
epoch:59/100 	 train_acc:100.0 	 val_acc:94.56521606445312 	 train_loss:0.0030924046877771616 	 val_loss:0.13277915120124817
epoch:60/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0014867079444229603 	 val_loss:0.08932869136333466
epoch:61/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.004148739855736494 	 val_loss:0.12538087368011475
epoch:62/100 	 train_acc:99.9455337524414 	 val_acc:95.2173843383789 	 train_loss:0.0045262728817760944 	 val_loss:0.1874173879623413
epoch:63/100 	 train_acc:100.0 	 val_acc:93.2608642578125 	 train_loss:0.0016400653403252363 	 val_loss:0.24857443571090698
epoch:64/100 	 train_acc:99.9455337524414 	 val_acc:94.99999237060547 	 train_loss:0.0013739819405600429 	 val_loss:0.1364113837480545
epoch:65/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.001069794176146388 	 val_loss:0.17955127358436584
epoch:66/100 	 train_acc:99.89106750488281 	 val_acc:95.2173843383789 	 train_loss:0.00359739875420928 	 val_loss:0.11309400200843811
epoch:67/100 	 train_acc:99.9455337524414 	 val_acc:94.56521606445312 	 train_loss:0.0022443868219852448 	 val_loss:0.16204963624477386
epoch:68/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0007774628465995193 	 val_loss:0.1743488609790802
epoch:69/100 	 train_acc:100.0 	 val_acc:94.56521606445312 	 train_loss:0.0015768304001539946 	 val_loss:0.16620150208473206
epoch:70/100 	 train_acc:100.0 	 val_acc:93.47825622558594 	 train_loss:0.016025394201278687 	 val_loss:0.10681857913732529
epoch:71/100 	 train_acc:99.9455337524414 	 val_acc:93.69564819335938 	 train_loss:0.0018376450752839446 	 val_loss:0.14144742488861084
epoch:72/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0025702028069645166 	 val_loss:0.12486795336008072
epoch:73/100 	 train_acc:99.89106750488281 	 val_acc:93.2608642578125 	 train_loss:0.0015624797670170665 	 val_loss:0.18054063618183136
epoch:74/100 	 train_acc:99.9455337524414 	 val_acc:95.2173843383789 	 train_loss:0.0029481337405741215 	 val_loss:0.14352315664291382
epoch:75/100 	 train_acc:100.0 	 val_acc:95.43477630615234 	 train_loss:0.0010955450125038624 	 val_loss:0.10692202299833298
epoch:76/100 	 train_acc:100.0 	 val_acc:94.34782409667969 	 train_loss:0.0013843246269971132 	 val_loss:0.14009718596935272
epoch:77/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.0019753477536141872 	 val_loss:0.13483113050460815
epoch:78/100 	 train_acc:99.89106750488281 	 val_acc:94.99999237060547 	 train_loss:0.0011122594587504864 	 val_loss:0.10735229402780533
epoch:79/100 	 train_acc:99.89106750488281 	 val_acc:94.56521606445312 	 train_loss:0.030210917815566063 	 val_loss:0.15859384834766388
epoch:80/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.000653013470582664 	 val_loss:0.1723790466785431
epoch:81/100 	 train_acc:99.9455337524414 	 val_acc:94.34782409667969 	 train_loss:0.0018780656391754746 	 val_loss:0.1027233824133873
epoch:82/100 	 train_acc:99.89106750488281 	 val_acc:94.56521606445312 	 train_loss:0.0008373963064514101 	 val_loss:0.13781872391700745
epoch:83/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.0021949978545308113 	 val_loss:0.17798946797847748
epoch:84/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.00041654056985862553 	 val_loss:0.12062618881464005
epoch:85/100 	 train_acc:99.9455337524414 	 val_acc:94.13043212890625 	 train_loss:0.003341002855449915 	 val_loss:0.14030754566192627
epoch:86/100 	 train_acc:99.89106750488281 	 val_acc:94.78260803222656 	 train_loss:0.0007001497433520854 	 val_loss:0.09663387387990952
epoch:87/100 	 train_acc:100.0 	 val_acc:94.99999237060547 	 train_loss:0.005182906519621611 	 val_loss:0.13306041061878204
epoch:88/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.00045127051998861134 	 val_loss:0.15296633541584015
epoch:89/100 	 train_acc:100.0 	 val_acc:93.69564819335938 	 train_loss:0.0006653143791481853 	 val_loss:0.18580806255340576
epoch:90/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.0013140881201252341 	 val_loss:0.21801157295703888
epoch:91/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.003482602536678314 	 val_loss:0.1441698968410492
epoch:92/100 	 train_acc:99.89106750488281 	 val_acc:94.34782409667969 	 train_loss:0.000342590908985585 	 val_loss:0.1679021567106247
epoch:93/100 	 train_acc:99.9455337524414 	 val_acc:94.99999237060547 	 train_loss:0.0018087017815560102 	 val_loss:0.09507827460765839
epoch:94/100 	 train_acc:100.0 	 val_acc:94.56521606445312 	 train_loss:0.003533995011821389 	 val_loss:0.1486368626356125
epoch:95/100 	 train_acc:99.89106750488281 	 val_acc:93.91304016113281 	 train_loss:0.0003364485455676913 	 val_loss:0.2211345136165619
epoch:96/100 	 train_acc:99.89106750488281 	 val_acc:94.13043212890625 	 train_loss:0.0014326013624668121 	 val_loss:0.11013278365135193
epoch:97/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.006995527073740959 	 val_loss:0.177200585603714
epoch:98/100 	 train_acc:99.89106750488281 	 val_acc:94.56521606445312 	 train_loss:0.0008913872879929841 	 val_loss:0.12421244382858276
epoch:99/100 	 train_acc:99.9455337524414 	 val_acc:93.91304016113281 	 train_loss:0.0035242177546024323 	 val_loss:0.21246370673179626
训练结束！